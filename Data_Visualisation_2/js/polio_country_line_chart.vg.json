{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "background": "white",
    "title": "Polio: Cases and Immunisation Coverage",
    "width": "container",
    "height": 220,
    "data": {
        "url": "https://raw.githubusercontent.com/ethan-lee-07/FIT3179/main/Data_Visualisation_2/data/polio_combined_country_processed.csv"
    },
    "params": [
        {
            "name": "country_selection",
            "value": "Afghanistan",
            "bind": {
                "input": "select",
                "options": [
                    "Afghanistan",                
                    "Angola",                
                    "Brazil",                
                    "China",                
                    "Egypt",                
                    "India",                
                    "Indonesia",                                    
                    "Kenya",
                    "Lao People's Democratic Republic",                
                    "Nigeria",                
                    "Pakistan",                
                    "Sudan",                
                    "Viet Nam"],
                "labels": [
                    "Afghanistan",                
                    "Angola",                
                    "Brazil",                
                    "China",                
                    "Egypt",                
                    "India",                
                    "Indonesia",                                    
                    "Kenya",
                    "Lao People's Democratic Republic",                
                    "Nigeria",                
                    "Pakistan",                
                    "Sudan",                
                    "Vietnam"],
                "name": "Country: "
            }
        }
    ],

    "transform": [
        {"filter": "datum.country == country_selection"}
    ],

    "encoding": {
        "x": {"field": "Year", "type": "quantitative", "title": "Year", "axis": {"format": "d", "tickCount": 10}},
        "color": {
            "type": "nominal",
            "scale": {"domain": ["Case Numbers", "Immunisation Coverage"], "range": ["red", "blue"]}
        }
    },

    "layer": [
        {   
            "description": "Red line corresponding to cases",
            "mark": {"type": "line", "strokeWidth": 3},
            "encoding": {
                "y": {"field": "Cases", "type": "quantitative", "axis": {"title": "Cases"}},
                "color": {"datum": "Case Numbers"},
                "tooltip": [
                    {"field": "country", "type": "nominal", "title": "Country"},
                    {"field": "Year", "type": "quantitative", "title": "Year"},
                    {"field": "Cases", "type": "nominal", "title": "Cases"}
                ]
            }
        },
        {
            "description": "Interactive point mark along red line",
            "params": [{
              "name": "label",
              "select": {
                "type": "point",
                "encodings": ["x"],
                "nearest": true,
                "on": "mouseover",
                "resolve": "intersect"
              }
            }],
            "mark": "point",
            "encoding": {
                "y": {"field": "Cases", "type": "quantitative", "axis": null},
                "opacity": {
                    "condition": {
                    "param": "label",
                    "empty": false,
                    "value": 1
                    },
                    "value": 0
                }
            }
        },
        {
            "transform": [{"filter": "datum.Coverage_Perc != 0"}],
            "mark": {"type": "line", "strokeWidth": 3, "strokeDash": [6,4]},
            "encoding": {
                "y": {"field": "Coverage_Perc", "type": "quantitative", "axis": {"title": "Immunisation Coverage (% of one-year-olds)"}},
                "color": {
                    "datum": "Immunisation Coverage"
                },
                "tooltip": [
                    {"field": "country", "type": "nominal", "title": "Country"},
                    {"field": "Coverage_Perc", "type": "nominal", "title": "Immunisation Coverage (%)"}
                ]
            }
        },
        {
            "description": "Interactive point mark along blue line",
            "params": [{
              "name": "tracking2",
              "select": {
                "type": "point",
                "encodings": ["x"],
                "nearest": true,
                "on": "mouseover",
                "resolve": "intersect"
              }
            }],
            "mark": "point",
            "encoding": {
                "y": {"field": "Coverage_Perc", "type": "quantitative", "axis": null},
                "opacity": {
                    "condition": {
                    "param": "tracking2",
                    "empty": false,
                    "value": 1
                    },
                    "value": 0
                }
            }
        }
    ],
    "resolve": {"scale": {"y": "independent"}},
    
    "config": {
        "axis": {"labelFont": "Inter", "titleFont": "Inter"},
        "legend": {
            "orient": "bottom-right",
            "labelFont": "Inter", 
            "titleFont": "Inter"
        },
        "header": {"labelFont": "Inter", "titleFont": "Inter"},
        "mark": {"font": "Inter"},
        "title": {"font": "Inter", "subtitleFont": "Inter"}
    }

}

